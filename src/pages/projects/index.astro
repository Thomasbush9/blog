---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects'))
  .sort((a, b) => a.data.order - b.data.order);

const basePath = import.meta.env.BASE_URL;
---

<BaseLayout title="Projects" description="My projects">
  <h1><span class="prompt">$</span> ls projects/</h1>
  <p class="subtitle">Total: {projects.length} projects</p>

  <div class="projects-grid">
    {projects.map((project) => (
      <article class="project-card">
        <h2>{project.data.title}</h2>
        <p class="description">{project.data.description}</p>
        <div class="links">
          {project.data.url && (
            <a href={project.data.url} target="_blank" rel="noopener">Demo →</a>
          )}
          {project.data.github && (
            <a href={project.data.github} target="_blank" rel="noopener">GitHub →</a>
          )}
        </div>
        {project.data.tags.length > 0 && (
          <div class="tags">
            {project.data.tags.map((tag) => (
              <span class="tag">{tag}</span>
            ))}
          </div>
        )}
      </article>
    ))}
  </div>
</BaseLayout>

<style>
  .prompt {
    color: var(--accent-green);
    margin-right: 0.5rem;
  }

  .subtitle {
    color: var(--text-muted);
    font-family: var(--font-mono);
    margin-bottom: 2rem;
  }

  .projects-grid {
    display: grid;
    gap: 1.5rem;
  }

  .project-card {
    padding: 1.5rem;
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    transition: all 0.15s ease;
  }

  .project-card:hover {
    border-color: var(--accent-mauve);
  }

  .project-card h2 {
    margin: 0 0 0.5rem;
    font-size: 1.25rem;
  }

  .description {
    color: var(--text-secondary);
    margin-bottom: 1rem;
  }

  .links {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
    font-family: var(--font-mono);
    font-size: 0.9rem;
  }

  .tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .tag {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    padding: 0.2rem 0.5rem;
    background: var(--bg-secondary);
    border-radius: var(--radius-sm);
    color: var(--text-muted);
  }
</style>
